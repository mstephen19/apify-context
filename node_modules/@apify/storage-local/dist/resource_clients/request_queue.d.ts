import type { DatabaseConnectionCache } from '../database_connection_cache';
import { RawQueueTableData } from '../emulators/request_queue_emulator';
import type { QueueOperationInfo } from '../emulators/queue_operation_info';
export interface RequestBody {
    id?: string;
    url: string;
    uniqueKey: string;
    method?: string;
    retryCount?: number;
    handledAt?: Date | string;
}
export interface QueueHead {
    limit: number;
    queueModifiedAt: Date;
    hadMultipleClients: boolean;
    items: unknown[];
}
export interface RequestModel {
    id?: string;
    queueId: string;
    orderNo: number | null;
    url: string;
    uniqueKey: string;
    method?: string;
    retryCount?: number;
    handledAt?: Date | string;
    json: string;
}
export interface RequestQueueClientOptions {
    name: string;
    storageDir: string;
    dbConnections: DatabaseConnectionCache;
}
export interface ListOptions {
    /**
     * @default 100
     */
    limit?: number;
}
export interface RequestOptions {
    forefront?: boolean;
}
export declare class RequestQueueClient {
    id: string;
    name: string;
    dbConnections: DatabaseConnectionCache;
    queueDir: string;
    private emulator;
    constructor({ dbConnections, name, storageDir }: RequestQueueClientOptions);
    /**
     * API client does not make any requests immediately after
     * creation so we simulate this by creating the emulator
     * lazily. The outcome is that an attempt to access a queue
     * that does not exist throws only at the access invocation,
     * which is in line with API client.
     */
    private _getEmulator;
    get(): Promise<RawQueueTableData | undefined>;
    update(newFields: {
        name?: string;
    }): Promise<RawQueueTableData | undefined>;
    delete(): Promise<void>;
    listHead(options?: ListOptions): Promise<QueueHead>;
    addRequest(request: RequestModel, options?: RequestOptions): Promise<QueueOperationInfo>;
    getRequest(id: string): Promise<Record<string, unknown> | undefined>;
    updateRequest(request: RequestModel, options?: RequestOptions): Promise<QueueOperationInfo>;
    deleteRequest(_id: string): Promise<never>;
    private _createRequestModel;
    /**
     * A partial index on the requests table ensures
     * that NULL values are not returned when querying
     * for queue head.
     */
    private _calculateOrderNo;
    private _jsonToRequest;
}
//# sourceMappingURL=request_queue.d.ts.map